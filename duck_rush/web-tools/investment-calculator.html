<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="tool-name" content="æŠ•èµ„è®¡ç®—å™¨">
    <meta name="tool-description" content="åŸºäºé•¿æœŸæŠ•èµ„å’Œå‚¨è“„çš„è´¢åŠ¡è§„åˆ’å·¥å…·ï¼Œå¸®åŠ©æ‚¨é¢„æµ‹æœªæ¥è´¢åŠ¡çŠ¶å†µã€‚">
    <title>æŠ•èµ„è®¡ç®—å™¨ | Duck Rush</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px 30px;
            text-align: center;
        }

        .header-title {
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .header-subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        main {
            padding: 40px 30px;
        }

        .section {
            margin-bottom: 40px;
        }

        .section-title {
            font-size: 1.5rem;
            color: #444;
            margin-bottom: 25px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-weight: 600;
            color: #555;
            margin-bottom: 8px;
            font-size: 0.95rem;
        }

        .form-group input {
            padding: 12px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-group .unit {
            font-size: 0.85rem;
            color: #777;
            margin-top: 4px;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-block;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(102, 126, 234, 0.3);
        }

        .btn:active {
            transform: translateY(0);
        }

        .results {
            margin-top: 40px;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 12px;
            border: 2px solid #e9ecef;
        }

        .results-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #444;
            margin-bottom: 20px;
        }

        .results-table {
            width: 100%;
            border-collapse: collapse;
            overflow-x: auto;
            display: block;
        }

        .results-table th,
        .results-table td {
            padding: 12px 16px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        .results-table th {
            background: #f0f0f0;
            font-weight: 600;
            color: #555;
            position: sticky;
            top: 0;
        }

        .results-table tr:hover {
            background: rgba(102, 126, 234, 0.05);
        }

        .results-table .positive {
            color: #28a745;
            font-weight: 500;
        }

        .results-table .negative {
            color: #dc3545;
            font-weight: 500;
        }

        .summary {
            margin-top: 30px;
            padding: 20px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .summary h3 {
            font-size: 1.1rem;
            font-weight: 600;
            color: #444;
            margin-bottom: 10px;
        }

        .summary p {
            color: #666;
            line-height: 1.4;
        }

        .back-link {
            display: inline-block;
            margin-top: 40px;
            padding: 12px 24px;
            background: #f0f0f0;
            color: #555;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .back-link:hover {
            background: #e0e0e0;
            transform: translateY(-2px);
        }

        .saved-params {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
        }

        .param-item {
            background: white;
            padding: 12px;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .param-item:hover {
            background: #f0f4ff;
            border-color: #667eea;
            transform: translateY(-1px);
        }

        .param-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .param-item-date {
            font-size: 0.8rem;
            color: #999;
        }

        .param-item-details {
            font-size: 0.9rem;
            color: #666;
            line-height: 1.3;
        }

        .param-item-amount {
            font-weight: 500;
            color: #667eea;
        }

        .no-params {
            text-align: center;
            color: #999;
            padding: 30px 0;
            font-style: italic;
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            header {
                padding: 30px 20px;
            }

            .header-title {
                font-size: 1.8rem;
            }

            main {
                padding: 30px 20px;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .results {
                padding: 20px;
            }

            .results-table {
                font-size: 0.9rem;
            }

            .results-table th,
            .results-table td {
                padding: 10px 12px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1 class="header-title">æŠ•èµ„è®¡ç®—å™¨</h1>
            <p class="header-subtitle">åŸºäºé•¿æœŸæŠ•èµ„å’Œå‚¨è“„çš„è´¢åŠ¡è§„åˆ’å·¥å…·</p>
        </header>

        <main>
            <section class="section">
                <h2 class="section-title">ğŸ“Š è¾“å…¥å‚æ•°</h2>
                <form id="investmentForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="savings">å¹´åˆè´¢å¯Œ</label>
                            <input type="number" id="savings" name="savings" value="0" min="0" step="1000">
                            <div class="unit">å•ä½ï¼šä¸‡å…ƒ</div>
                        </div>

                        <div class="form-group">
                            <label for="income">åˆå§‹å¹´æ”¶å…¥</label>
                            <input type="number" id="income" name="income" value="100" min="0" step="10">
                            <div class="unit">å•ä½ï¼šä¸‡å…ƒ</div>
                        </div>

                        <div class="form-group">
                            <label for="workYears">å·¥ä½œå¹´é™</label>
                            <input type="number" id="workYears" name="workYears" value="10" min="1" max="50">
                            <div class="unit">å•ä½ï¼šå¹´</div>
                        </div>

                        <div class="form-group">
                            <label for="incomeIncreaseRate">å¹´æ”¶å…¥å¢é•¿ç‡</label>
                            <input type="number" id="incomeIncreaseRate" name="incomeIncreaseRate" value="5" min="0" max="100" step="0.1">
                            <div class="unit">å•ä½ï¼š%</div>
                        </div>

                        <div class="form-group">
                            <label for="spend">å¹´æ”¯å‡º</label>
                            <input type="number" id="spend" name="spend" value="20" min="0" step="10">
                            <div class="unit">å•ä½ï¼šä¸‡å…ƒ</div>
                        </div>

                        <div class="form-group">
                            <label for="spendIncreaseRate">æ”¯å‡ºå¢é•¿ç‡</label>
                            <input type="number" id="spendIncreaseRate" name="spendIncreaseRate" value="2" min="0" max="100" step="0.1">
                            <div class="unit">å•ä½ï¼š%</div>
                        </div>

                        <div class="form-group">
                            <label for="investmentReturnRate">æŠ•èµ„å›æŠ¥ç‡</label>
                            <input type="number" id="investmentReturnRate" name="investmentReturnRate" value="10" min="0" max="100" step="0.1">
                            <div class="unit">å•ä½ï¼š%</div>
                        </div>

                        <div class="form-group">
                            <label for="totalYears">è®¡ç®—æ€»å¹´é™</label>
                            <input type="number" id="totalYears" name="totalYears" value="50" min="1" max="100">
                            <div class="unit">å•ä½ï¼šå¹´</div>
                        </div>

                        <div class="form-group">
                            <label for="birthYear">å‡ºç”Ÿå¹´ä»½</label>
                            <input type="number" id="birthYear" name="birthYear" value="1990" min="1900" max="2026">
                            <div class="unit">æ ¼å¼ï¼šYYYY</div>
                        </div>
                    </div>

                    <div style="display: flex; gap: 10px; margin-top: 15px;">
                        <button type="button" class="btn" onclick="calculateInvestment()">å¼€å§‹è®¡ç®—</button>
                        <button type="button" class="btn" style="background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);" onclick="saveParameters()">ä¿å­˜å‚æ•°</button>
                    </div>
                </form>
            </section>

            <section class="section">
                <h2 class="section-title">ğŸ“ˆ è®¡ç®—ç»“æœ</h2>
                <div id="results" class="results" style="display: none;">
                    <h3 class="results-title">å¹´åº¦è´¢åŠ¡çŠ¶å†µ</h3>
                    <table class="results-table" id="resultsTable">
                        <thead>
                            <tr>
                                <th>å¹´ä»½</th>
                                <th>ç»å¯¹å¹´ä»½</th>
                                <th>å¹´é¾„</th>
                                <th>å¹´æ”¶å…¥</th>
                                <th>æŠ•èµ„æ”¶å…¥</th>
                                <th>æ¶ˆè´¹æ”¯å‡º</th>
                                <th>å¹´åˆè´¢å¯Œ</th>
                                <th>å¹´åº•è´¢å¯Œ</th>
                            </tr>
                        </thead>
                        <tbody id="resultsBody">
                            <!-- è®¡ç®—ç»“æœå°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                        </tbody>
                    </table>

                    <div class="summary" id="summary">
                        <h3>ğŸ“‹ è´¢åŠ¡æ€»ç»“</h3>
                        <p id="summaryText"></p>
                    </div>
                </div>
            </section>

            <section class="section">
                <h2 class="section-title">ğŸ’¾ ä¿å­˜çš„å‚æ•°</h2>
                <div id="savedParamsList" class="saved-params">
                    <div id="paramsList" style="margin-top: 15px;">
                        <!-- ä¿å­˜çš„å‚æ•°åˆ—è¡¨å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>
            </section>

            <a href="web-tools-index.html" class="back-link">â¬…ï¸ è¿”å›å·¥å…·ç´¢å¼•</a>
        </main>
    </div>

    <!-- Toast æç¤º -->
    <div id="toast" class="toast" style="position: fixed; top: 20px; right: 20px; background: #4CAF50; color: white; padding: 12px 20px; border-radius: 4px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15); z-index: 2100; transform: translateX(400px); transition: transform 0.3s ease; opacity: 0;">
        <span id="toastMessage"></span>
    </div>

    <!-- è‡ªå®šä¹‰å¯¹è¯æ¡† -->
    <div id="customDialog" class="custom-dialog" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 2000; align-items: center; justify-content: center;">
        <div class="dialog-content" style="background: white; border-radius: 8px; padding: 24px; width: 90%; max-width: 400px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);">
            <div class="dialog-header" style="margin-bottom: 16px;">
                <h3 id="dialogTitle" class="dialog-title" style="margin: 0; font-size: 1.1rem; font-weight: 600; color: #333;"></h3>
            </div>
            <div class="dialog-body" style="margin-bottom: 20px;">
                <p id="dialogMessage" class="dialog-message" style="margin: 0; color: #666; line-height: 1.4;"></p>
            </div>
            <div class="dialog-footer" style="display: flex; gap: 10px; justify-content: flex-end;">
                <button id="dialogCancelBtn" class="dialog-btn" style="padding: 8px 16px; border: 1px solid #e0e0e0; border-radius: 4px; background: white; color: #666; cursor: pointer; transition: all 0.2s ease;">å–æ¶ˆ</button>
                <button id="dialogConfirmBtn" class="dialog-btn" style="padding: 8px 16px; border: none; border-radius: 4px; background: #667eea; color: white; cursor: pointer; transition: all 0.2s ease;">ç¡®å®š</button>
            </div>
        </div>
    </div>

    <script>
        function formatMoney(value, roundDigits = 2) {
            /*
            æ ¼å¼åŒ–é‡‘é¢ï¼Œè¶…è¿‡1äº¿ä½¿ç”¨äº¿å•ä½è¡¨ç¤º
            */
            if (value >= 10000) {
                // è¶…è¿‡1äº¿ï¼ˆ10000ä¸‡å…ƒï¼‰ï¼Œä½¿ç”¨äº¿å•ä½
                return (value / 10000).toFixed(roundDigits) + 'äº¿';
            } else {
                // æœªè¶…è¿‡1äº¿ï¼Œä½¿ç”¨åŸå•ä½
                return value.toFixed(roundDigits);
            }
        }

        function calculateAge(birthYear, currentYear) {
            /*
            æ ¹æ®å‡ºç”Ÿå¹´ä»½è®¡ç®—å¹´é¾„
            */
            return currentYear - birthYear;
        }

        function saveParameters() {
            /*
            ä¿å­˜å‚æ•°åˆ°localStorageï¼Œæœ€å¤šæ”¯æŒ100æ¡è®°å½•
            */
            // è·å–è¡¨å•æ•°æ®
            const params = {
                savings: parseFloat(document.getElementById('savings').value) || 0,
                workYears: parseInt(document.getElementById('workYears').value) || 10,
                income: parseFloat(document.getElementById('income').value) || 30,
                incomeIncreaseRate: parseFloat(document.getElementById('incomeIncreaseRate').value) || 5,
                spend: parseFloat(document.getElementById('spend').value) || 20,
                spendIncreaseRate: parseFloat(document.getElementById('spendIncreaseRate').value) || 2,
                investmentReturnRate: parseFloat(document.getElementById('investmentReturnRate').value) || 10,
                totalYears: parseInt(document.getElementById('totalYears').value) || 50,
                birthYear: parseInt(document.getElementById('birthYear').value) || 1990,
                timestamp: new Date().toISOString()
            };

            // ä»localStorageè·å–ç°æœ‰è®°å½•
            let savedParams = JSON.parse(localStorage.getItem('investmentCalculatorParams') || '[]');

            // æ·»åŠ æ–°è®°å½•åˆ°å¼€å¤´
            savedParams.unshift(params);

            // é™åˆ¶æœ€å¤š100æ¡è®°å½•
            if (savedParams.length > 100) {
                savedParams = savedParams.slice(0, 100);
            }

            // ä¿å­˜å›localStorage
            localStorage.setItem('investmentCalculatorParams', JSON.stringify(savedParams));

            // æ˜¾ç¤ºä¿å­˜æˆåŠŸæç¤º
            showToast('å‚æ•°å·²æˆåŠŸä¿å­˜ï¼');
            loadSavedParameters();
        }

        function calculateInvestment() {
            // è·å–è¡¨å•æ•°æ®
            const form = document.getElementById('investmentForm');
            const savings = parseFloat(document.getElementById('savings').value) || 0;
            const workYears = parseInt(document.getElementById('workYears').value) || 10;
            const income = parseFloat(document.getElementById('income').value) || 100;
            const incomeIncreaseRate = parseFloat(document.getElementById('incomeIncreaseRate').value) / 100 || 0.05;
            const spend = parseFloat(document.getElementById('spend').value) || 20;
            const spendIncreaseRate = parseFloat(document.getElementById('spendIncreaseRate').value) / 100 || 0.02;
            const investmentReturnRate = parseFloat(document.getElementById('investmentReturnRate').value) / 100 || 0.1;
            const totalYears = parseInt(document.getElementById('totalYears').value) || 50;
            const birthYear = parseInt(document.getElementById('birthYear').value) || 1990;

            // è®¡ç®—é€»è¾‘
            let incomeThisYear = income;
            let spendThisYear = spend;
            let currentSavings = savings;
            let workedYears = 0;
            const startYear = new Date().getFullYear();

            // æ¸…ç©ºç»“æœ
            const resultsBody = document.getElementById('resultsBody');
            resultsBody.innerHTML = '';

            // è®¡ç®—æ¯å¹´çš„æ•°æ®
            for (let year = 0; year < totalYears; year++) {
                const absYear = startYear + year;
                workedYears++;

                // å·¥ä½œå¹´é™ç»“æŸåï¼Œæ”¶å…¥å˜ä¸º0
                if (workedYears > workYears) {
                    incomeThisYear = 0;
                }

                // å¹´åˆè´¢å¯Œ
                const startWealth = currentSavings;

                // è®¡ç®—æŠ•èµ„æ”¶å…¥
                const investment = startWealth * investmentReturnRate;

                // è®¡ç®—å¹´åº•è´¢å¯Œ
                currentSavings = startWealth + incomeThisYear + investment - spendThisYear;
                currentSavings = Math.max(0, currentSavings); // ç¡®ä¿å‚¨è“„ä¸ä¸ºè´Ÿ

                // è®¡ç®—å¹´é¾„
                const age = calculateAge(birthYear, absYear);

                // æ·»åŠ åˆ°ç»“æœè¡¨æ ¼
                const row = document.createElement('tr');
                const formattedIncome = formatMoney(incomeThisYear);
                const formattedInvestment = formatMoney(investment);
                const formattedSpend = formatMoney(spendThisYear);
                const formattedStartWealth = formatMoney(startWealth);
                const formattedEndWealth = formatMoney(currentSavings);
                
                row.innerHTML = `
                    <td>${year + 1}</td>
                    <td>${absYear}</td>
                    <td>${age}</td>
                    <td>${formattedIncome}${formattedIncome.includes('äº¿') ? '' : 'ä¸‡'}</td>
                    <td class="positive">${formattedInvestment}${formattedInvestment.includes('äº¿') ? '' : 'ä¸‡'}</td>
                    <td class="negative">${formattedSpend}${formattedSpend.includes('äº¿') ? '' : 'ä¸‡'}</td>
                    <td>${formattedStartWealth}${formattedStartWealth.includes('äº¿') ? '' : 'ä¸‡'}</td>
                    <td>${formattedEndWealth}${formattedEndWealth.includes('äº¿') ? '' : 'ä¸‡'}</td>
                `;
                resultsBody.appendChild(row);

                // æ›´æ–°ä¸‹ä¸€å¹´çš„æ”¶å…¥å’Œæ”¯å‡º
                incomeThisYear = incomeThisYear * (1 + incomeIncreaseRate);
                spendThisYear = spendThisYear * (1 + spendIncreaseRate);
            }

            // ç”Ÿæˆæ€»ç»“
            const summaryText = document.getElementById('summaryText');
            const formattedSavings = formatMoney(currentSavings);
            const savingsUnit = currentSavings >= 10000 ? '' : ' ä¸‡';
            summaryText.innerHTML = `
                åŸºäºæ‚¨çš„è¾“å…¥å‚æ•°ï¼Œç»è¿‡ ${totalYears} å¹´çš„æŠ•èµ„å’Œå‚¨è“„ï¼Œæœ€ç»ˆå‚¨è“„ä¸º <strong>${formattedSavings}${savingsUnit}</strong>ã€‚
                <br><br>
                å…³é”®å‡è®¾ï¼š
                <ul style="margin-top: 10px; padding-left: 20px;">
                    <li>å·¥ä½œå¹´é™ï¼š${workYears} å¹´</li>
                    <li>å¹´æ”¶å…¥å¢é•¿ç‡ï¼š${(incomeIncreaseRate * 100).toFixed(1)}%</li>
                    <li>æ”¯å‡ºå¢é•¿ç‡ï¼š${(spendIncreaseRate * 100).toFixed(1)}%</li>
                    <li>æŠ•èµ„å›æŠ¥ç‡ï¼š${(investmentReturnRate * 100).toFixed(1)}%</li>
                </ul>
                <br>
                æ³¨æ„ï¼šæ­¤è®¡ç®—ä»…ä¾›å‚è€ƒï¼Œå®é™…æŠ•èµ„æ”¶ç›Šä¼šå—åˆ°å¸‚åœºæ³¢åŠ¨ç­‰å¤šç§å› ç´ å½±å“ã€‚
            `;

            // æ˜¾ç¤ºç»“æœ
            document.getElementById('results').style.display = 'block';
        }

        // Toast å‡½æ•°
        function showToast(message, duration = 2000) {
            /*
            æ˜¾ç¤ºè‡ªå®šä¹‰ toast æç¤º
            */
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toastMessage');

            toastMessage.textContent = message;
            toast.style.transform = 'translateX(0)';
            toast.style.opacity = '1';

            setTimeout(() => {
                toast.style.transform = 'translateX(400px)';
                toast.style.opacity = '0';
            }, duration);
        }

        // è‡ªå®šä¹‰å¯¹è¯æ¡†å‡½æ•°
        let dialogCallback = null;

        function showAlert(message, title = 'æç¤º') {
            /*
            æ˜¾ç¤ºè‡ªå®šä¹‰ alert å¯¹è¯æ¡†
            */
            const dialog = document.getElementById('customDialog');
            const dialogTitle = document.getElementById('dialogTitle');
            const dialogMessage = document.getElementById('dialogMessage');
            const dialogCancelBtn = document.getElementById('dialogCancelBtn');
            const dialogConfirmBtn = document.getElementById('dialogConfirmBtn');

            dialogTitle.textContent = title;
            dialogMessage.textContent = message;
            dialogCancelBtn.style.display = 'none';
            dialogConfirmBtn.textContent = 'ç¡®å®š';

            dialog.style.display = 'flex';

            // ç»‘å®šç¡®å®šæŒ‰é’®äº‹ä»¶
            function handleConfirm() {
                dialog.style.display = 'none';
                dialogConfirmBtn.removeEventListener('click', handleConfirm);
            }

            dialogConfirmBtn.addEventListener('click', handleConfirm);
        }

        function showConfirm(message, title = 'ç¡®è®¤', callback) {
            /*
            æ˜¾ç¤ºè‡ªå®šä¹‰ confirm å¯¹è¯æ¡†
            */
            const dialog = document.getElementById('customDialog');
            const dialogTitle = document.getElementById('dialogTitle');
            const dialogMessage = document.getElementById('dialogMessage');
            const dialogCancelBtn = document.getElementById('dialogCancelBtn');
            const dialogConfirmBtn = document.getElementById('dialogConfirmBtn');

            dialogTitle.textContent = title;
            dialogMessage.textContent = message;
            dialogCancelBtn.style.display = 'inline-block';
            dialogConfirmBtn.textContent = 'ç¡®å®š';

            dialog.style.display = 'flex';
            dialogCallback = callback;

            // ç»‘å®šæŒ‰é’®äº‹ä»¶
            function handleConfirm() {
                dialog.style.display = 'none';
                if (typeof dialogCallback === 'function') {
                    dialogCallback(true);
                }
                dialogConfirmBtn.removeEventListener('click', handleConfirm);
                dialogCancelBtn.removeEventListener('click', handleCancel);
            }

            function handleCancel() {
                dialog.style.display = 'none';
                if (typeof dialogCallback === 'function') {
                    dialogCallback(false);
                }
                dialogConfirmBtn.removeEventListener('click', handleConfirm);
                dialogCancelBtn.removeEventListener('click', handleCancel);
            }

            dialogConfirmBtn.addEventListener('click', handleConfirm);
            dialogCancelBtn.addEventListener('click', handleCancel);
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            loadSavedParameters();
        });

        function loadSavedParameters() {
            /*
            åŠ è½½ä¿å­˜çš„å‚æ•°åˆ—è¡¨å¹¶æ˜¾ç¤º
            */
            const paramsList = document.getElementById('paramsList');
            const savedParams = JSON.parse(localStorage.getItem('investmentCalculatorParams') || '[]');

            if (savedParams.length === 0) {
                paramsList.innerHTML = '<div class="no-params">æš‚æ— ä¿å­˜çš„å‚æ•°</div>';
                return;
            }

            paramsList.innerHTML = '';

            savedParams.forEach((params, index) => {
                const paramItem = document.createElement('div');
                paramItem.className = 'param-item';

                const date = new Date(params.timestamp);
                const formattedDate = date.toLocaleString('zh-CN', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit'
                });

                paramItem.innerHTML = `
                    <div class="param-item-header">
                        <span>å‚æ•° #${index + 1}</span>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <span class="param-item-date">${formattedDate}</span>
                            <button type="button" class="delete-btn" style="background: #ff4757; color: white; border: none; border-radius: 4px; padding: 4px 8px; font-size: 0.7rem; cursor: pointer;">åˆ é™¤</button>
                        </div>
                    </div>
                    <div class="param-item-details" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 8px;">
                        <div>å¹´åˆè´¢å¯Œï¼š<span class="param-item-amount">${params.savings.toFixed(2)}</span> ä¸‡å…ƒ</div>
                        <div>åˆå§‹å¹´æ”¶å…¥ï¼š<span class="param-item-amount">${params.income.toFixed(2)}</span> ä¸‡å…ƒ</div>
                        <div>å·¥ä½œå¹´é™ï¼š<span class="param-item-amount">${params.workYears}</span> å¹´</div>
                        <div>å¹´æ”¶å…¥å¢é•¿ç‡ï¼š<span class="param-item-amount">${params.incomeIncreaseRate.toFixed(1)}</span>%</div>
                        <div>å¹´æ”¯å‡ºï¼š<span class="param-item-amount">${params.spend.toFixed(2)}</span> ä¸‡å…ƒ</div>
                        <div>æ”¯å‡ºå¢é•¿ç‡ï¼š<span class="param-item-amount">${params.spendIncreaseRate.toFixed(1)}</span>%</div>
                        <div>æŠ•èµ„å›æŠ¥ç‡ï¼š<span class="param-item-amount">${params.investmentReturnRate.toFixed(1)}</span>%</div>
                        <div>æ€»å¹´é™ï¼š<span class="param-item-amount">${params.totalYears}</span> å¹´</div>
                        <div>å‡ºç”Ÿå¹´ä»½ï¼š<span class="param-item-amount">${params.birthYear}</span></div>
                    </div>
                `;

                // æ·»åŠ æ¢å¤å‚æ•°çš„ç‚¹å‡»äº‹ä»¶ï¼ˆæ’é™¤åˆ é™¤æŒ‰é’®ï¼‰
                paramItem.addEventListener('click', function(e) {
                    if (!e.target.classList.contains('delete-btn')) {
                        restoreParameters(params);
                    }
                });

                // æ·»åŠ åˆ é™¤æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶
                const deleteBtn = paramItem.querySelector('.delete-btn');
                deleteBtn.addEventListener('click', function(e) {
                    e.stopPropagation(); // é˜»æ­¢äº‹ä»¶å†’æ³¡
                    deleteParameter(index);
                });

                paramsList.appendChild(paramItem);
            });
        }

        function restoreParameters(params) {
            /*
            æ¢å¤å‚æ•°åˆ°è¾“å…¥æ¡†
            */
            document.getElementById('savings').value = params.savings;
            document.getElementById('workYears').value = params.workYears;
            document.getElementById('income').value = params.income;
            document.getElementById('incomeIncreaseRate').value = params.incomeIncreaseRate;
            document.getElementById('spend').value = params.spend;
            document.getElementById('spendIncreaseRate').value = params.spendIncreaseRate;
            document.getElementById('investmentReturnRate').value = params.investmentReturnRate;
            document.getElementById('totalYears').value = params.totalYears;
            document.getElementById('birthYear').value = params.birthYear;

            showToast('å‚æ•°å·²æˆåŠŸæ¢å¤ï¼');
            // è‡ªåŠ¨è§¦å‘é‡æ–°è®¡ç®—
            calculateInvestment();
        }

        function deleteParameter(index) {
            /*
            åˆ é™¤ä¿å­˜çš„å‚æ•°
            */
            showConfirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå‚æ•°å—ï¼Ÿ', 'åˆ é™¤ç¡®è®¤', function(confirmed) {
                if (confirmed) {
                    let savedParams = JSON.parse(localStorage.getItem('investmentCalculatorParams') || '[]');
                    savedParams.splice(index, 1); // åˆ é™¤æŒ‡å®šç´¢å¼•çš„å‚æ•°
                    localStorage.setItem('investmentCalculatorParams', JSON.stringify(savedParams));
                    loadSavedParameters(); // é‡æ–°åŠ è½½å‚æ•°åˆ—è¡¨
                }
            });
        }
    </script>
</body>
</html>